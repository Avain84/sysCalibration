import{h as m,k,l as S,a as n,o,b as r,n as c,e as h,j as C,w as v,t as g,m as B,F as f,p as w,g as O,d as x,u as b,q as _,v as $,R as L}from"./index-C9GdA9Z-.js";import{i as R,a as N,u as P}from"./request-DXs0tBU2.js";import{_ as V}from"./logo-lg-BqCaA2gN.js";import{_ as z}from"./IconButton-BmZJosq_.js";const D="data:image/svg+xml,%3csvg%20width='10'%20height='10'%20viewBox='0%200%2010%2010'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_150_3558)'%3e%3crect%20width='9.6'%20height='9.6'%20transform='translate(0.400024%200.199951)'%20fill='white'%20fill-opacity='0.01'/%3e%3cpath%20d='M4.9291%207.16172L1.9316%203.73547C1.57785%203.33234%201.86535%202.69922%202.40223%202.69922H8.39723C8.51738%202.69912%208.63501%202.73365%208.73605%202.79868C8.83708%202.86372%208.91722%202.95649%208.96688%203.0659C9.01654%203.17531%209.03361%203.29672%209.01605%203.41558C8.99849%203.53444%208.94703%203.64572%208.86785%203.73609L5.87035%207.16109C5.81169%207.22822%205.73934%207.28203%205.65817%207.31889C5.577%207.35576%205.48888%207.37483%205.39973%207.37483C5.31057%207.37483%205.22246%207.35576%205.14128%207.31889C5.06011%207.28203%204.98776%207.22822%204.9291%207.16109V7.16172Z'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_150_3558'%3e%3crect%20width='9.6'%20height='9.6'%20fill='white'%20transform='translate(0.400024%200.199951)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e";function E(i={}){return R({url:"/user/getProfile",method:"post",token:!0,data:i})}const j={class:"fixed top-0 left-0 w-full h-15 shadow-md px-4 py-1.5 flex justify-center items-center"},M={key:0,class:"absolute w-32 right-1/6 mt-2 bg-white shadow-md rounded-md border border-neutral-80 overflow-hidden"},T={__name:"Navbar",props:{isSidebarOpen:Boolean},emits:["toggleSidebar"],setup(i){const d=m({role:"company",username:"使用者名稱"}),a=m(!1),s=m(!1),u=m(null),p=()=>{s.value=!s.value},l=e=>{u.value&&!u.value.contains(e.target)&&(s.value=!1)},y=async()=>{try{const e=await E();d.value=e.payload,a.value=e.payload.role==="employee"}catch(e){console.log(e)}};return k(()=>{y(),document.addEventListener("click",l)}),S(()=>{document.removeEventListener("click",l)}),(e,t)=>(o(),n("header",j,[r("button",{onClick:t[0]||(t[0]=H=>e.$emit("toggleSidebar")),class:"cursor-pointer mr-4 xl:hidden relative w-8 h-8 flex flex-col justify-between items-center p-1 group"},[r("span",{class:c(["block rounded-full h-1 w-full transform transition duration-300",[a.value?"bg-primary-40 group-hover:bg-primary-60":"bg-tertiary-40 group-hover:bg-tertiary-60",{"rotate-45 translate-y-2.5":i.isSidebarOpen}]])},null,2),r("span",{class:c(["block rounded-full h-1 w-full transition duration-300",[a.value?"bg-primary-40 group-hover:bg-primary-60":"bg-tertiary-40 group-hover:bg-tertiary-60",{"opacity-0":i.isSidebarOpen}]])},null,2),r("span",{class:c(["block rounded-full h-1 w-full transform transition duration-300",[a.value?"bg-primary-40 group-hover:bg-primary-60":"bg-tertiary-40 group-hover:bg-tertiary-60",{"-rotate-45 -translate-y-2.5":i.isSidebarOpen}]])},null,2)]),t[4]||(t[4]=r("h1",{class:"mr-auto text-h4B lg:text-h3B text-primary-30"},[r("a",{href:"/#/system",class:"flex justify-center items-center gap-4"},[r("img",{src:V,alt:"system logo",class:"w-10 lg:w-12 aspect-square"}),r("span",{class:"hidden sm:block"},"設備校驗系統平台")])],-1)),r("div",{ref_key:"userDropdownRef",ref:u,class:"relative",onClick:p},[h(z,{type:"button",size:"sm",role:d.value.role,rounded:"full"},{default:v(()=>[r("span",null,g(d.value.username),1),t[1]||(t[1]=r("img",{src:D,alt:"arrow",class:"w-2.5 aspect-square"},null,-1))]),_:1},8,["role"]),s.value?(o(),n("ul",M,[r("li",{class:c(["px-4 py-2 hover:text-white",[a.value?"hover:bg-primary-30":"hover:bg-tertiary-30"]])},t[2]||(t[2]=[r("a",{href:"#"},"個人資料",-1)]),2),r("li",{class:c(["px-4 py-2 hover:bg-primary-30 hover:text-white",[a.value?"hover:bg-primary-30":"hover:bg-tertiary-30"]])},t[3]||(t[3]=[r("a",{href:"#"},"登出",-1)]),2)])):C("",!0)],512)]))}},q={class:"p-4"},U=["onClick"],F={__name:"Sidebar",props:{isSidebarOpen:Boolean},setup(i){const d=B(),a=[{name:"儀錶板",path:"/dashboard"},{name:"校驗商管理",path:"/company-management"},{name:"系統設定",path:"",children:[{name:"權限設定",path:"/system/permissions"},{name:"偏好設定",path:"/system/preferences"}]}],s=m(""),u=l=>{s.value===l?s.value="":s.value=l},p=l=>s.value===l;return(l,y)=>(o(),n("aside",{class:c(["bg-white xl:bg-white/30 z-50 top-15 left-0 w-full xl:w-1/4 min-h-full shadow-lg",i.isSidebarOpen?"fixed":"hidden"])},[r("ul",q,[(o(),n(f,null,w(a,e=>r("li",{key:e.name,class:"px-6 py-2"},[e.children&&e.children.length>0?(o(),n(f,{key:0},[r("button",{class:"text-lg w-full text-left pl-4 border-l-4 border-transparent hover:border-primary-60",onClick:t=>u(e.name)},g(e.name),9,U),p(e.name)?(o(),n("ul",{key:0,class:c(["",p(e.name)?"block mt-2 px-3 py-3 border-t border-secondary-90":"hidden"])},[(o(!0),n(f,null,w(e.children,t=>(o(),n("li",{key:t.name,class:"px-3"},[h(b(_),{to:t.path,class:"block text-lg px-3 py-1 rounded-lg border border-transparent hover:border-secondary-90"},{default:v(()=>[x(g(t.name),1)]),_:2},1032,["to"])]))),128))],2)):C("",!0)],64)):(o(),O(b(_),{key:1,to:e.path,class:c(["text-lg w-full pl-4 border-l-4 border-transparent hover:border-primary-60",{"text-primary-60 !border-primary-60 font-bold":b(d).path===e.path}])},{default:v(()=>[x(g(e.name),1)]),_:2},1032,["to","class"]))])),64))])],2))}},W={class:"container grid grid-cols-12 mx-auto"},A={class:"xl:col-start-4 col-span-12 xl:col-span-9 mt-15"},K={__name:"SidebarWithNavbar",setup(i){const{goToRoute:d}=P(),a=m(!1),s=()=>{a.value=!a.value},u=()=>{a.value=window.innerWidth>=1280};return k(()=>{$("token")||(N().error("登入過期","請重新登入"),d("companyLogin")),u(),window.addEventListener("resize",u)}),(p,l)=>(o(),n(f,null,[h(T,{"is-sidebar-open":a.value,onToggleSidebar:s},null,8,["is-sidebar-open"]),h(F,{"is-sidebar-open":a.value},null,8,["is-sidebar-open"]),r("main",W,[r("div",A,[h(b(L))])])],64))}};export{K as default};
